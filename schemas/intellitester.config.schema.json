{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Global configuration file for IntelliTester",
  "type": "object",
  "properties": {
    "defaults": {
      "description": "Default settings that apply to all tests unless overridden",
      "type": "object",
      "properties": {
        "timeout": {
          "description": "Default timeout in milliseconds for all actions",
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        },
        "screenshots": {
          "description": "When to capture screenshots during test execution",
          "type": "string",
          "enum": [
            "on-failure",
            "always",
            "never"
          ]
        }
      },
      "additionalProperties": false
    },
    "ai": {
      "description": "AI configuration for test generation and healing",
      "type": "object",
      "properties": {
        "provider": {
          "description": "AI provider to use for test generation",
          "type": "string",
          "enum": [
            "anthropic",
            "openai",
            "ollama"
          ]
        },
        "model": {
          "description": "Model name to use",
          "type": "string",
          "minLength": 1
        },
        "apiKey": {
          "description": "API key for the AI provider",
          "type": "string"
        },
        "baseUrl": {
          "description": "Base URL for the AI API (required for Ollama)",
          "type": "string",
          "format": "uri"
        },
        "temperature": {
          "description": "Temperature for AI generation (0 = deterministic, 2 = very creative)",
          "default": 0.2,
          "type": "number",
          "minimum": 0,
          "maximum": 2
        },
        "maxTokens": {
          "description": "Maximum tokens for AI responses",
          "default": 4096,
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        },
        "source": {
          "description": "Source code directories for AI to analyze when generating tests",
          "type": "object",
          "properties": {
            "pagesDir": {
              "description": "Directory containing page components",
              "type": "string"
            },
            "componentsDir": {
              "description": "Directory containing reusable components",
              "type": "string"
            },
            "extensions": {
              "description": "File extensions to include in source code analysis",
              "default": [
                ".vue",
                ".astro",
                ".tsx",
                ".jsx",
                ".svelte"
              ],
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          },
          "required": [
            "extensions"
          ],
          "additionalProperties": false
        }
      },
      "required": [
        "provider",
        "model",
        "temperature",
        "maxTokens"
      ],
      "additionalProperties": false
    },
    "platforms": {
      "description": "Platform-specific configurations",
      "type": "object",
      "properties": {
        "web": {
          "description": "Web platform configuration",
          "type": "object",
          "properties": {
            "baseUrl": {
              "description": "Base URL for the web application",
              "type": "string",
              "minLength": 1,
              "format": "uri"
            },
            "browser": {
              "description": "Browser to use for testing",
              "type": "string"
            },
            "headless": {
              "description": "Run browser in headless mode",
              "type": "boolean"
            },
            "timeout": {
              "description": "Timeout in milliseconds for web actions",
              "type": "integer",
              "exclusiveMinimum": 0,
              "maximum": 9007199254740991
            }
          },
          "additionalProperties": false
        },
        "android": {
          "description": "Android platform configuration",
          "type": "object",
          "properties": {
            "appId": {
              "description": "Android application ID",
              "type": "string"
            },
            "device": {
              "description": "Device name or ID to run tests on",
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "ios": {
          "description": "iOS platform configuration",
          "type": "object",
          "properties": {
            "bundleId": {
              "description": "iOS bundle identifier",
              "type": "string"
            },
            "simulator": {
              "description": "Simulator name to run tests on",
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "healing": {
      "description": "Self-healing test configuration",
      "type": "object",
      "properties": {
        "enabled": {
          "description": "Enable self-healing capabilities",
          "type": "boolean"
        },
        "strategies": {
          "description": "Healing strategies to use",
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false
    },
    "email": {
      "description": "Email testing configuration",
      "type": "object",
      "properties": {
        "provider": {
          "description": "Email testing provider",
          "type": "string",
          "const": "inbucket"
        },
        "endpoint": {
          "description": "Email service endpoint URL",
          "type": "string",
          "minLength": 1,
          "format": "uri"
        }
      },
      "required": [
        "provider"
      ],
      "additionalProperties": false
    },
    "appwrite": {
      "description": "Appwrite backend configuration",
      "type": "object",
      "properties": {
        "endpoint": {
          "description": "Appwrite API endpoint",
          "type": "string",
          "minLength": 1,
          "format": "uri"
        },
        "projectId": {
          "description": "Appwrite project ID",
          "type": "string",
          "minLength": 1
        },
        "apiKey": {
          "description": "Appwrite API key with appropriate permissions",
          "type": "string",
          "minLength": 1
        },
        "cleanup": {
          "description": "Enable automatic cleanup of created resources",
          "type": "boolean"
        },
        "cleanupOnFailure": {
          "description": "Clean up resources even when test fails",
          "type": "boolean"
        }
      },
      "required": [
        "endpoint",
        "projectId",
        "apiKey"
      ],
      "additionalProperties": false
    },
    "cleanup": {
      "description": "Comprehensive resource cleanup configuration",
      "type": "object",
      "properties": {
        "provider": {
          "description": "Primary cleanup provider to use",
          "type": "string"
        },
        "parallel": {
          "description": "Execute cleanup operations in parallel",
          "default": false,
          "type": "boolean"
        },
        "retries": {
          "description": "Number of retry attempts for failed cleanup operations",
          "default": 3,
          "type": "number",
          "minimum": 1,
          "maximum": 10
        },
        "types": {
          "description": "Map resource types to cleanup handler methods",
          "type": "object",
          "propertyNames": {
            "type": "string"
          },
          "additionalProperties": {
            "type": "string"
          }
        },
        "handlers": {
          "description": "Explicit paths to custom cleanup handler files",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "discover": {
          "description": "Auto-discovery configuration for cleanup handlers",
          "type": "object",
          "properties": {
            "enabled": {
              "description": "Enable auto-discovery of cleanup handlers in specified paths",
              "default": true,
              "type": "boolean"
            },
            "paths": {
              "description": "Directories to search for cleanup handler files",
              "default": [
                "./tests/cleanup"
              ],
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "pattern": {
              "description": "Glob pattern to match handler files",
              "default": "**/*.ts",
              "type": "string"
            }
          },
          "required": [
            "enabled",
            "paths",
            "pattern"
          ],
          "additionalProperties": false
        },
        "scanUntracked": {
          "type": "boolean",
          "description": "Scan for untracked resources using provider heuristics"
        }
      },
      "required": [
        "parallel",
        "retries"
      ],
      "additionalProperties": {}
    },
    "webServer": {
      "type": "object",
      "properties": {
        "command": {
          "description": "Command to start the web server",
          "type": "string",
          "minLength": 1
        },
        "auto": {
          "description": "Automatically detect and run the dev server from package.json",
          "type": "boolean"
        },
        "static": {
          "description": "Serve a static directory instead of running a command",
          "type": "string"
        },
        "url": {
          "description": "URL to wait for before starting tests",
          "type": "string",
          "minLength": 1,
          "format": "uri"
        },
        "port": {
          "description": "Port number for the web server",
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        },
        "reuseExistingServer": {
          "description": "Use existing server if already running at the specified URL",
          "default": true,
          "type": "boolean"
        },
        "timeout": {
          "description": "Timeout in milliseconds to wait for server to become available",
          "default": 30000,
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        },
        "cwd": {
          "description": "Working directory for the server command",
          "type": "string"
        }
      },
      "required": [
        "url",
        "reuseExistingServer",
        "timeout"
      ],
      "additionalProperties": false
    },
    "preview": {
      "description": "Configuration for the --preview flag (build and serve production build)",
      "type": "object",
      "properties": {
        "build": {
          "description": "Build configuration",
          "type": "object",
          "properties": {
            "command": {
              "description": "Command to build the project",
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "preview": {
          "description": "Preview server configuration",
          "type": "object",
          "properties": {
            "command": {
              "description": "Command to start the preview server after build",
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "url": {
          "description": "URL to wait for before starting tests",
          "type": "string",
          "format": "uri"
        },
        "timeout": {
          "description": "Timeout in milliseconds to wait for preview server",
          "type": "integer",
          "exclusiveMinimum": 0,
          "maximum": 9007199254740991
        }
      },
      "additionalProperties": false
    },
    "secrets": {
      "description": "Secret values that can be referenced in tests",
      "type": "object",
      "propertyNames": {
        "type": "string"
      },
      "additionalProperties": {
        "type": "string"
      }
    }
  },
  "additionalProperties": false,
  "title": "IntelliTester Configuration"
}